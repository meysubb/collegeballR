<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basketball Example • collegeballR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Basketball Example">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">collegeballR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="http://meysubb.github.io">Personal Homepage</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://twitter.com/msubbaiah1">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/meysubb/collegeballR">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Basketball Example</h1>
            
      
      
      <div class="hidden name"><code>Basketball_Ex.Rmd</code></div>

    </div>

    
    
<p>This example will focus on looking at SEC basketball players for 2017-2018. Data is accquired using the <code>player_stats</code> function found in <code>collegeballR</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggrepel)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(data.table)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(collegeballR)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(rvest)
sec_urls &lt;-<span class="st"> "http://stats.ncaa.org/team/inst_team_list?academic_year=2018&amp;conf_id=911&amp;division=1&amp;sport_code=MBB"</span>

team_names &lt;-<span class="st"> </span><span class="kw">read_html</span>(sec_urls) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rvest.tidyverse.org/reference/html_nodes.html">html_nodes</a></span>(<span class="st">".css-panes a"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rvest.tidyverse.org/reference/html_text.html">html_text</a></span>()
team_names &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/trimws">trimws</a></span>(team_names)
teams &lt;-<span class="st"> </span><span class="kw"><a href="../reference/team_mapping.html">team_mapping</a></span>(<span class="dv">2018</span>,<span class="st">"MBB"</span>)
sec &lt;-<span class="st"> </span>teams <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(team_name <span class="op">%in%</span><span class="st"> </span>team_names) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(
  <span class="dt">team_id =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(team_id)
)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(sec)</code></pre></div>
<pre><code>##   team_id team_name year
## 1       8   Alabama 2018
## 2      31  Arkansas 2018
## 3      37    Auburn 2018
## 4     235   Florida 2018
## 5     257   Georgia 2018
## 6     334  Kentucky 2018</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sec_player_stats &lt;-<span class="st"> </span>sec <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(
  <span class="dt">team_id =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(team_id),
  <span class="dt">player_df =</span> purrr<span class="op">::</span><span class="kw"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span>(team_id,player_stats,<span class="dt">year=</span><span class="dv">2018</span>,<span class="dt">sport=</span><span class="st">"MBB"</span>)
)</code></pre></div>
<p>I’ll look to incorporate a conference type function, just have to scale it out to all sports easily.</p>
<p>So there is an example above of using the <code>player_stats</code> function within purrr to get data for all SEC teams in basketball.</p>
<div id="cleaning-data" class="section level3">
<h3 class="hasAnchor">
<a href="#cleaning-data" class="anchor"></a>Cleaning Data</h3>
<p>Let’s bring all the data into one dataframe for all teams.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sec_player_l &lt;-<span class="st"> </span>sec_player_stats <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(player_df) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span>()

sec_player_df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/rbindlist">rbindlist</a></span>(sec_player_l,<span class="dt">fill=</span>T) 
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(sec_player_df)[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">20</span>,<span class="dv">21</span>)] &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"PPG"</span>,<span class="st">"RPG"</span>)
sec_player_df &lt;-<span class="st"> </span>sec_player_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">inner_join</a></span>(.,sec) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span>G,<span class="op">-</span>team_id)</code></pre></div>
<p>Note to self, look at all sport player sites and see if Average is repeated more than once. It seems for basketball they are using Avg right after point and rebound data. It’s sort of odd, I’ll try and find a way to fix this.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sec_player_df &lt;-<span class="st"> </span>sec_player_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(
  <span class="dt">MP =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/grep">gsub</a></span>(<span class="st">"</span><span class="ch">\\</span><span class="st">:.*"</span>,<span class="st">""</span>,MP))
)

sec_player_df[,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"FGM"</span>,<span class="st">"FGA"</span>,<span class="st">"DRebs"</span>,<span class="st">"Tot Reb"</span>)] &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">sapply</a></span>(sec_player_df[,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"FGM"</span>,<span class="st">"FGA"</span>,<span class="st">"DRebs"</span>,<span class="st">"Tot Reb"</span>)],as.numeric)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(sec_player_df)</code></pre></div>
<pre><code>##   Jersey             Player Yr Pos   Ht GP GS   MP FGM FGA   FG% 3FG 3FGA
## 1     05 Johnson Jr., Avery Jr   G 5-11 36  0  501  51 146 34.93  20   67
## 2     23        Petty, John Fr   G  6-5 36 28 1026 123 313 39.30  90  242
## 3     12      Ingram, Dazon So   G  6-5 35 32 1007 100 235 42.55  19   67
## 4     10     Jones, Herbert Fr   G  6-7 35 13  741  58 142 40.85   7   26
## 5     00        Hall, Donta Jr   F  6-9 34 30  806 151 208 72.60  NA   NA
## 6      4    Giddens, Daniel So   F 6-11 34 17  451  58  99 58.59  NA   NA
##    3FG%  FT FTA   FT% PTS   PPG  RPG ORebs DRebs Tot Reb AST TO STL BLK
## 1 29.85  32  40 80.00 154  4.28 1.08    12    27      39  27 19  17   1
## 2 37.19  32  45 71.11 368 10.22 2.56    14    78      92  65 74  17   9
## 3 28.36 122 177 68.93 341  9.74 5.71    33   167     200  92 79  30  12
## 4 26.92  24  48 50.00 147  4.20 3.46    29    92     121  48 56  44  22
## 5    NA  60 108 55.56 362 10.65 6.59    76   148     224  20 43  24  68
## 6    NA  28  48 58.33 144  4.24 2.53    28    58      86   8 34  14  35
##   Fouls Dbl Dbl Trpl Dbl DQ year team_name
## 1    54      NA       NA  1 2018   Alabama
## 2    36      NA       NA NA 2018   Alabama
## 3    93       2       NA  3 2018   Alabama
## 4    94      NA       NA  4 2018   Alabama
## 5    59       5       NA NA 2018   Alabama
## 6    95      NA       NA  2 2018   Alabama</code></pre>
<p>But for now the data is cleaned and team names are added back. Depending on the sport you select the data will look like this, with differing stats recorded. From this you can move on to creating advanced metrics, etc.</p>
</div>
<div id="advanced-stats" class="section level3">
<h3 class="hasAnchor">
<a href="#advanced-stats" class="anchor"></a>Advanced Stats</h3>
<p>Let’s calculate usage rate. First we need to calculate some team based stats, before calculating USG rate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sec_p_df &lt;-<span class="st"> </span>sec_player_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(team_name) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(
  <span class="dt">team_minutes =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(MP,<span class="dt">na.rm=</span>T),
  <span class="dt">team_FGA =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(FGA,<span class="dt">na.rm=</span>T),
  <span class="dt">team_FTA =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(FTA,<span class="dt">na.rm=</span>T),
  <span class="dt">team_TO =</span>  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(TO,<span class="dt">na.rm=</span>T)
) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.data.frame">as.data.frame</a></span>()
sec_p_df[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NA">is.na</a></span>(sec_p_df)] &lt;-<span class="st"> </span><span class="dv">0</span>
sec_p_df &lt;-<span class="st"> </span>sec_p_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(
  <span class="dt">usg_rate =</span> <span class="dv">100</span> <span class="op">*</span><span class="st"> </span>((FGA <span class="op">+</span><span class="st"> </span><span class="fl">0.475</span> <span class="op">*</span><span class="st"> </span>FTA <span class="op">+</span><span class="st"> </span>TO) <span class="op">*</span><span class="st"> </span>(team_minutes<span class="op">/</span><span class="dv">5</span>)) <span class="op">/</span><span class="st"> </span>(MP <span class="op">*</span><span class="st"> </span>(team_FGA <span class="op">+</span><span class="st"> </span><span class="fl">0.475</span> <span class="op">*</span><span class="st"> </span>team_FTA <span class="op">+</span><span class="st"> </span>team_TO))
  )</code></pre></div>
</div>
<div id="plotting" class="section level3">
<h3 class="hasAnchor">
<a href="#plotting" class="anchor"></a>Plotting</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ind_df &lt;-<span class="st"> </span>sec_p_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(MP<span class="op">&gt;</span><span class="dv">100</span>)
labels &lt;-<span class="st"> </span>ind_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(usg_rate<span class="op">&gt;</span><span class="dv">25</span> <span class="op">&amp;</span><span class="st"> </span>MP <span class="op">&gt;</span><span class="st"> </span><span class="dv">750</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>() <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_point">geom_point</a></span>(<span class="dt">data =</span> ind_df, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">y =</span> MP, <span class="dt">x =</span> usg_rate, <span class="dt">color =</span> team_name)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_bw</a></span>(<span class="dt">base_size=</span><span class="dv">16</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggrepel/topics/geom_text_repel">geom_text_repel</a></span>(<span class="dt">data =</span> labels, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> usg_rate, <span class="dt">y =</span> MP, <span class="dt">label =</span> Player)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/facet_wrap">facet_wrap</a></span>(<span class="op">~</span>team_name) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">x =</span> <span class="st">"Usage Rate"</span>, <span class="dt">y =</span> <span class="st">"Minutes"</span>, <span class="dt">caption =</span> <span class="st">"@msubbaiah1"</span>,
       <span class="dt">title =</span> <span class="st">"SEC Basketball Usage Rate by team"</span>,
       <span class="dt">subtitle =</span> <span class="st">"2017 - 2018 season"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"none"</span>)</code></pre></div>
<p><img src="Basketball_Ex_files/figure-html/unnamed-chunk-5-1.png" width="960"></p>
<p>There is the basics of getting player data from collegeballR!</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Meyappan Subbaiah.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
